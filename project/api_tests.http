###
# Backend API Testing
# Use the REST Client extension to run these requests
# Click "Send Request" above each request or use Ctrl+Alt+R
###

### Variables
@backend_url = http://localhost:5001
@frontend_url = http://localhost:5000

###############################################################################
# Backend Service Tests
###############################################################################

### 1. Health Check
GET {{backend_url}}/api/health HTTP/1.1

###

### 2. Start Session
GET {{backend_url}}/api/start HTTP/1.1

###

### 3. Get First Question
# Run "Start Session" first
GET {{backend_url}}/api/question/first HTTP/1.1

###

### 4. Get Available Answers
GET {{backend_url}}/api/answers HTTP/1.1

###

### 5. Process Answer
POST {{backend_url}}/api/answer HTTP/1.1
Content-Type: application/json

{
    "question_id": 1,
    "answer_id": 1
}

###

### 6. Get Next Question
GET {{backend_url}}/api/question/next HTTP/1.1

###

### 7. Get Theorems
GET {{backend_url}}/api/theorems?question_id=1&answer_id=1&base_threshold=0.01 HTTP/1.1

###

### 8. Get Session State
GET {{backend_url}}/api/session/state HTTP/1.1

###

### 9. End Session with Feedback
POST {{backend_url}}/api/session/end HTTP/1.1
Content-Type: application/json

{
    "feedback_id": 5,
    "triangle_types": [2, 3],
    "helpful_theorems": [15, 23, 41]
}

###

### 10. End Session - Resume Request
POST {{backend_url}}/api/session/end HTTP/1.1
Content-Type: application/json

{
    "feedback_id": 7
}

###

###############################################################################
# Error Testing
###############################################################################

### Test: Missing Session (should return error)
GET {{backend_url}}/api/question/first HTTP/1.1

###

### Test: Invalid Answer Data
POST {{backend_url}}/api/answer HTTP/1.1
Content-Type: application/json

{
    "question_id": "invalid"
}

###

### Test: Missing Required Fields
POST {{backend_url}}/api/answer HTTP/1.1
Content-Type: application/json

{
    "question_id": 1
}

###

### Test: 404 Not Found
GET {{backend_url}}/api/nonexistent HTTP/1.1

###

###############################################################################
# Complete Workflow Example
###############################################################################

### STEP 1: Start Session
GET {{backend_url}}/api/start HTTP/1.1

###

### STEP 2: Get First Question
GET {{backend_url}}/api/question/first HTTP/1.1

###

### STEP 3: Process Answer (Yes = 1)
POST {{backend_url}}/api/answer HTTP/1.1
Content-Type: application/json

{
    "question_id": 1,
    "answer_id": 1
}

###

### STEP 4: Get Theorems for that Answer
GET {{backend_url}}/api/theorems?question_id=1&answer_id=1 HTTP/1.1

###

### STEP 5: Get Next Question
GET {{backend_url}}/api/question/next HTTP/1.1

###

### STEP 6: Process Second Answer (No = 0)
POST {{backend_url}}/api/answer HTTP/1.1
Content-Type: application/json

{
    "question_id": 2,
    "answer_id": 0
}

###

### STEP 7: Check Session State
GET {{backend_url}}/api/session/state HTTP/1.1

###

### STEP 8: End Session with Feedback
POST {{backend_url}}/api/session/end HTTP/1.1
Content-Type: application/json

{
    "feedback_id": 5,
    "triangle_types": [1, 2],
    "helpful_theorems": [10, 15, 20]
}

###

###############################################################################
# Frontend Service (Quick Check)
###############################################################################

### Check if Frontend is Running
GET {{frontend_url}}/ HTTP/1.1

###
